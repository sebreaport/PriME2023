<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>PriME Login</title>
    <script
      src="https://code.jquery.com/jquery-3.4.1.js"
      integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
      crossorigin="anonymous">
    </script>
    <script type="text/javascript">

      window.onload=function(){
        document.getElementById("Subbutton").addEventListener("click", submit, false);
        importinput();
      }

      var yourData = [];
      function importinput (){
        // const fetch = require('isomorphic-fetch');
        fetch("https://api.sheetson.com/v2/sheets/results", {
          headers: {
            "Authorization": "Bearer 8gfhXEvvAd57e6U-wCebSKLtNs3e5GsskqTJsSsR0ZCiG6YQDDHfA_RQJcs",
            "X-Spreadsheet-Id": "1-P4AOtFzTTVX8ok3ZjvrwirSEffLhXBRJvZZ56pCeFA",
          }
        }).then(r => r.json())
        .then(result => {
          yourData = result["results"];
          document.getElementById("Subbutton").innerHTML = "Log in";
          document.getElementById("Subbutton").disabled = false;
        })
      }

      function submit (){
        var username = document.getElementById("username").value;
        var password = document.getElementById("password").value;
        let checker = 0;
        for(let i = 0; i < yourData.length; i++){
          let rowInfo = yourData[i]
          if (username == rowInfo["User"] && password == rowInfo["Password"]) {
            checker = 1; //Confirms username and password
            localStorage.setItem("loggedin",1);
            if (username == "stationManager") {
              //window.location = "boothdashboard.html";
            }else {
              localStorage.setItem("username", username);
              localStorage.setItem("yourData", JSON.stringify(yourData));
              alert("Success! Welcome " + username +"!");
              window.location = "facidashboard.html";
            }
          }
        }
        if (checker == 0) {
          alert("Invalid Username / Password")
        }
      }
    </script>
    <style>
      @font-face {
        font-family: "CodeProBold";
        src: url("./fonts/Code Pro Bold LC.otf");
      }

      @font-face {
        font-family: "Hero";
        src: url("./fonts/Hero.otf");
      }

      *{
        padding: 0px;
        margin: 0px;
      }

      :root{
        --red: #B8555A;
        --orange: #FC9141;
        --yellow: #E8C46E;
        --blue: #5EAAAF;
        --green: #839B7B;
        --lightBrown: #94816D;
        --brown: #57453B;
        --darkBrown: #2E2E2B;
        --beige: #D1B07A;
      }

      body{
        background: url("./images/login_bg.png");
        background-size: cover;
      }

      .logocontainer{
        display: flex;
        width: 100%;
        align-items: center;
        justify-content: center;
        padding-top: 50px;
      }

      .logo{
        height: 200px;
      }

      .formcontainer{
        width: 40%;
        margin: 30px auto 50px;
        padding: 20px;
        border-radius: 10px;
        border: 5px solid var(-beige);
        text-align: center;
      }

      input{
        font-size: 20px;
        padding: 5px;
        text-align: center;
        border: 1px solid gray;
        margin: 2px;
      }

      h1{
        color: var(--darkBrown);
        font-family: "CodeProBold";
        margin: 10px;
      }

      p {
        font-family: "Hero";
        font-size: 20px;
        color: var(--darkBrown);
        margin: 20px;
      }

      button{
        font-family: "CodeProBold";
        color: white;
        margin: 20px;
        padding: 10px;
        border-radius: 10px;
        border-color: var(--red);
        background-color: var(--red);
      }

      button:hover{
        color: var(--darkBrown);
      }

      input{
        font-family: "Hero";
        border-radius: 10px;
      }

    </style>
  </head>

  <body>
    <div class="logocontainer"><img class="logo "src="./images/logo.png"></div>
    <div class="formcontainer">
      <h1>Welcome to PriME 2023: PROTOPIA!</h1>
      <p>Please log in to proceed!</p>
      <form class="Login">
        <input type="text" name="name" id="username" value="" placeholder="Username"/><br>
        <input type="password" name="password" id="password" value="" placeholder="Password"/>
      </form>
      <button id="Subbutton" disabled="true" type="submit" name="button">Loading...</button>
    </div>
  </body>
</html>
